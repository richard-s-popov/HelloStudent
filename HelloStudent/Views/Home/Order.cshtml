@{
    ViewBag.Title = "Заказ работ";
    Layout = "~/Views/Shared/_LayoutMin.cshtml";
}
@model HelloStudent.Models.OrderModel

<div class="order-container">
    @if (ViewBag.Finish)
    {
        <div class="congratulations">
            <h2>Спасибо!</h2>
            <p>Номер Вашей заявки №@Model.OrderNumber</p>
            <p>На Вашу почту @Model.Email отправлено информационное письмо.</p>
            <h3>Что дальше?</h3>
            <p>1. Менеджер подберет специалиста и сообщит Вам стоимость такой работы.</p>
            <p>2. Вам останется принять решение.</p>
            <h3>Принимая решение, Вы должны знать, что:</h3>
            <p>... работа не будет скачанной из Интернета.</p>
            <p>... работа будет уникальной, написанной по Вашим требованиям.</p>
            <p>... при написании работы, автор будет пользоваться книгами и оригинальными источниками.</p>
            <p>... что замечания устраним бесплатно, пока результат не устроит преподавателя.</p>
        </div>
    }
    <div class="title-page">
        <h1>Заказ работ</h1>
    </div>
    <div class="contacts">
        <div class="description-page">
            <p>Заполните, пожалуйста, форму предварительной заявки. Менеджер произведет оценку вашей работы. Это займет совсем немного времени.@*<br />Предлагаем помощь в написании дипломных проектов и контрольных работ, курсовых работ, рефератов, докладов, тезисов по различным отрослям наук.*@</p>
        </div>
        
        <div class="order-form">
            <h3>Узнайте прямо сейчас сколько стоит написать Вашу работу</h3>
            @using (Html.BeginForm("OrderFinish", "Home", FormMethod.Post))
            {
                <div class="first-step order-step">
                    <div class="order-row">
                        <span class="order-label">Тема работы <p class="asterisk">*</p></span>
                        <span class="order-field">
                            @Html.TextAreaFor(m => m.WorkSubject, new { @placeholder = "Напишите тему вашей работы, по возможности полностью" })
                        </span>
                    </div>
                    <div class="order-row">
                        <span class="order-label">Тип работы <p class="asterisk">*</p></span>
                        <span class="order-field">
                            @Html.DropDownListFor(m => m.WorkType, new List<SelectListItem>
                                {
                                    new SelectListItem
                                        {
                                            Text = "Дипломная работа",
                                            Value = "Дипломная работа"
                                        },
                                    new SelectListItem
                                        {
                                            Text = "Часть дипломной работы",
                                            Value = "Часть дипломной работы"
                                        },
                                    new SelectListItem
                                        {
                                            Text = "Отчет о практике",
                                            Value = "Отчет о практике"
                                        },
                                    new SelectListItem
                                        {
                                            Text = "Курсовая с практикой",
                                            Value = "Курсовая с практикой"
                                        },
                                    new SelectListItem
                                        {
                                            Text = "Курсовая теория",
                                            Value = "Курсовая теория"
                                        },
                                    new SelectListItem
                                        {
                                            Text = "Реферат",
                                            Value = "Реферат"
                                        },
                                    new SelectListItem
                                        {
                                            Text = "Реферат для асперантуры",
                                            Value = "Реферат для асперантуры"
                                        },
                                    new SelectListItem
                                        {
                                            Text = "Презентация в PowerPoint",
                                            Value = "Презентация в PowerPoint"
                                        },
                                    new SelectListItem
                                        {
                                            Text = "Задачи",
                                            Value = "Задачи"
                                        },
                                    new SelectListItem
                                        {
                                            Text = "Контрольная работа",
                                            Value = "Контрольная работа"
                                        },
                                    new SelectListItem
                                        {
                                            Text = "Тест",
                                            Value = "Тест"
                                        },
                                    new SelectListItem
                                        {
                                            Text = "Чертежи",
                                            Value = "Чертежи"
                                        },
                                    new SelectListItem
                                        {
                                            Text = "Юридическая консультация",
                                            Value = "Юридическая консультация"
                                        },
                                    new SelectListItem
                                        {
                                            Text = "Поиск информации",
                                            Value = "Поиск информации"
                                        },
                                    new SelectListItem
                                        {
                                            Text = "Эссе",
                                            Value = "Эссе"
                                        },
                                    new SelectListItem
                                        {
                                            Text = "Сопроводительные материалы к диплому",
                                            Value = "Сопроводительные материалы к диплому"
                                        },
                                    new SelectListItem
                                        {
                                            Text = "Другое",
                                            Value = "Другое"
                                        }
                                })
                        </span>
                    </div>
                    <div class="order-row">
                        <span class="order-label">Предмет</span>
                        <span class="order-field">
                            @Html.TextBoxFor(m => m.Subject, new { @placeholder = "По какому предмету пишется работа?" })
                        </span>
                    </div>
                    <div class="order-row">
                        <span class="order-label">Что требуется</span>
                        <span class="order-field">
                            @Html.TextAreaFor(m => m.Description, new { @placeholder = "Напишите развёрнуто требования к работе или какие-то нюансы, если они есть" })
                        </span>
                    </div>
                    <div class="order-row">
                        <span class="order-label">Когда нужна работа</span>
                        <span class="order-field">
                            @Html.TextBoxFor(m => m.Date, new { @placeholder = "Введите дату" })
                        </span>
                    </div>
                    <div class="order-row">
                        <span class="order-label">Почта <p class="asterisk">*</p></span>
                        <span class="order-field">
                            @Html.TextBoxFor(m => m.Email, new { @placeholder = "Ваш e-mail" })
                        </span>
                    </div>
                    <div class="order-row">
                        <span class="order-label">Телефон</span>
                        <span class="order-field">
                            @Html.TextBoxFor(m => m.Phone, new { @placeholder = "Например +79212712233" })
                        </span>
                    </div>
                    <div class="order-row">
                        <span class="order-label"></span>
                        <span class="order-field">
                            <span style="margin-top: 5px; display: inline-block; padding-top: 10px; border-top: 1px solid rgb(240, 240, 240); width: 275px; text-align: center;">
                                <p class="asterisk">*</p> Обязательные для заполнения поля
                            </span>
                        </span>
                    </div>
                    <div class="next-button" onclick="submitOrder()">Узнать цену сейчас</div>
                </div>
            }
        </div>
        <div class="order-right">
            <p>Также работу на оценку можно прислать Нам и старым, проверенным способом, через почту. Для более оперативного ответа по Вашему заказу в этом случае просим Вас связаться с нами одним из следующих способов:</p>
            <div class="contacts-data">
                <p>Советская, 83 (антикафе "Вместе")</p>
                <p><b>Телефоны:</b></p>
                <p>+7-953-916-0500</p>
                <p>(3822) 50-74-89</p>
                <p>(+7-913-820-7489)</p>
                <p><b>E-mail:</b> scienceplus@yandex.ru</p>
                <p><b>ICQ:</b> 363-416-407</p>
                <p><a href="http://vk.com/hellostudentru">http://vk.com/hellostudentru</a></p>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    $.datepicker.regional['ru'] = {
        clearText: 'Очистить', clearStatus: '',
        minDate: "0",
        closeText: 'Закрыть', closeStatus: '',
        prevText: '<Пред', prevStatus: '',
        nextText: 'След>', nextStatus: '',
        currentText: 'Сегодня', currentStatus: '',
        monthNames: ['Январь', 'Февраль', 'Март', 'Апрель', 'Май', 'Июнь',
            'Июль', 'Август', 'Сентябрь', 'Октябрь', 'Ноябрь', 'Декабрь'],
        monthNamesShort: ['Янв', 'Фев', 'Мар', 'Апр', 'Май', 'Июн',
            'Июл', 'Авг', 'Сен', 'Окт', 'Ноя', 'Дек'],
        monthStatus: '', yearStatus: '',
        weekHeader: 'Не', weekStatus: '',
        dayNames: ['воскресенье', 'понедельник', 'вторник', 'среда', 'четверг', 'пятница', 'суббота'],
        dayNamesShort: ['вск', 'пнд', 'втр', 'срд', 'чтв', 'птн', 'сбт'],
        dayNamesMin: ['Вс', 'Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб'],
        dayStatus: 'DD', dateStatus: 'D, M d',
        dateFormat: 'dd.mm.yy', firstDay: 1,
        initStatus: '', isRTL: false,
        onSelect: function () {
            
        }
    };
    
    $('#Date').datepicker($.datepicker.regional["ru"]);

    function submitOrder() {
        jValOrder.errors = false;
        jValOrder.workSubject();
        jValOrder.email();
        jValOrder.phone();

        if (!jValOrder.errors) {
            $('form').submit();
        }
    }

    var jValOrder = {
        'workSubject': function () {
            var ele = $('textarea[name="WorkSubject"]');
            var pos = ele.position();
            ele.parent().append('<div id="workSubjectInfo" class="info"></div>');
            var nameInfo = $('#workSubjectInfo');

            nameInfo.css({
                top: pos.top - 1,
                left: pos.left + ele.width() + 15
            });

            if ($.trim(ele.val()).length == 0) {
                jValOrder.errors = true;
                nameInfo.addClass('error').html('Введите тему Вашей работы').show();
                nameInfo.prev().addClass('error-input');
                ele.removeClass('normal').addClass('wrong');
            } else if (ele.val().length > 255) {
                jValOrder.errors = true;
                nameInfo.addClass('error').html('Превышен максимальный размер 255 символов').show();
                ele.removeClass('normal').addClass('wrong').css({ 'font-weight': 'normal' });
                nameInfo.prev().addClass('error-input');
            } else {
                nameInfo.removeClass('error');
                ele.removeClass('wrong').addClass('normal');
                nameInfo.prev().removeClass('error-input');
            }
        },
        'email': function () {
            var ele = $('input[name="Email"]');
            var pos = ele.offset();
            ele.parent().append('<div id="emailInfo" class="info"></div>');
            var emailInfo = $('#emailInfo');

            emailInfo.css({
                top: pos.top + 4,
                left: pos.left + ele.width() + 25
            });

            var patt = /^.+@@.+[.].{2,}$/i;

            if ($.trim(ele.val()).length > 0) {
                if (!patt.test(ele.val())) {
                    jValOrder.errors = true;
                    emailInfo.addClass('error').html('Введите корректный Email').show();
                    ele.removeClass('normal').addClass('wrong');
                    emailInfo.prev().addClass('error-input');
                } else if (ele.val().length > 50) {
                    jValOrder.errors = true;
                    emailInfo.addClass('error').html('Превышен максимальный размер 50 символов').show();
                    ele.removeClass('normal').addClass('wrong').css({ 'font-weight': 'normal' });
                    emailInfo.prev().addClass('error-input');
                } else {
                    emailInfo.removeClass('error');
                    ele.removeClass('wrong').addClass('normal');
                    emailInfo.prev().removeClass('error-input');
                }
            } else {
                jValOrder.errors = true;
                emailInfo.addClass('error').html('Введите Email').show();
                emailInfo.prev().addClass('error-input');
                ele.removeClass('normal').addClass('wrong').css({ 'font-weight': 'normal' });
            }
        },
        'phone': function () {
            var ele = $('.order-row input[name="Phone"]');
            var pos = ele.position();
            ele.parent().append('<div id="phoneInfo" class="info"></div>');
            var phoneInfo = $('#phoneInfo');

            phoneInfo.css({
                top: pos.top + 4,
                left: pos.left + ele.width() + 25
            });

            var patt = /^([\+]{1})?[0-9\-]*$/i;

            if (ele.val().length != 0 && (ele.val().length > 15 || ele.val().length < 5 || !patt.test(ele.val()))) {
                jValOrder.errors = true;
                phoneInfo.addClass('error').html('Введите корректный номер телефона').show();
                ele.removeClass('normal').addClass('wrong').css({ 'font-weight': 'normal' });
                phoneInfo.prev().addClass('error-input');
            } else {
                phoneInfo.removeClass('error');
                ele.removeClass('wrong').addClass('normal');
                phoneInfo.prev().removeClass('error-input');
            }
        }
    };
</script>